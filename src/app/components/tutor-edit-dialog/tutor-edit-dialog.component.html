<div class="tutor-edit-dialog">
  <h1 mat-dialog-title>{{ 'profile.editTutorProfile' | translate }}</h1>
  
  <form [formGroup]="tutorForm" (ngSubmit)="onSave()">
    <mat-stepper #stepper>
      <!-- Información Básica -->
      <mat-step [stepControl]="tutorForm.get('basicInfo')!">
        <ng-template matStepLabel>{{ 'profile.basicInfo' | translate }}</ng-template>
        
        <div formGroupName="basicInfo" class="step-content">
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.fullName' | translate }}</mat-label>
            <input matInput formControlName="fullName" required>
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.phone' | translate }}</mat-label>
            <input matInput formControlName="phone" type="tel">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.country' | translate }}</mat-label>
            <input matInput formControlName="country">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.birthDate' | translate }}</mat-label>
            <input matInput formControlName="birthDate" type="date">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.birthLanguage' | translate }}</mat-label>
            <mat-select formControlName="birthLanguage">
              <mat-option *ngFor="let language of availableLanguages" [value]="language.code">
                {{ getLocalizedLanguageName(language) }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.photoUrl' | translate }}</mat-label>
            <input matInput formControlName="photoUrl" type="url">
          </mat-form-field>
        </div>
        
        <div class="step-actions">
          <button mat-raised-button color="primary" matStepperNext>
            {{ 'common.next' | translate }}
          </button>
        </div>
      </mat-step>
      
      <!-- Información Profesional -->
      <mat-step [stepControl]="tutorForm.get('professionalInfo')!">
        <ng-template matStepLabel>{{ 'profile.professionalInfo' | translate }}</ng-template>
        
        <div formGroupName="professionalInfo" class="step-content">
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.experienceLevel' | translate }}</mat-label>
            <mat-select formControlName="experienceLevel">
              <mat-option *ngFor="let level of experienceLevels" [value]="level">
                {{ ('experienceLevel.' + level) | translate }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          
          <div class="hourly-rate-group">
            <mat-form-field appearance="outline">
              <mat-label>{{ 'profile.hourlyRate' | translate }}</mat-label>
              <input matInput formControlName="hourlyRate" type="number" min="0">
            </mat-form-field>
            
            <mat-form-field appearance="outline">
              <mat-label>{{ 'profile.currency' | translate }}</mat-label>
              <mat-select formControlName="currency">
                <mat-option *ngFor="let currency of currencies" [value]="currency">
                  {{ currency }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.maxHoursPerWeek' | translate }}</mat-label>
            <input matInput formControlName="maxHoursPerWeek" type="number" min="0">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.biography' | translate }}</mat-label>
            <textarea matInput formControlName="biography" rows="4"></textarea>
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.linkedinProfile' | translate }}</mat-label>
            <input matInput formControlName="linkedinProfile" type="url">
          </mat-form-field>
          
          <mat-form-field appearance="outline">
            <mat-label>{{ 'profile.timezone' | translate }}</mat-label>
            <input matInput formControlName="timezone">
          </mat-form-field>
        </div>
        
        <div class="step-actions">
          <button mat-button matStepperPrevious>{{ 'common.back' | translate }}</button>
          <button mat-raised-button color="primary" matStepperNext>
            {{ 'common.next' | translate }}
          </button>
        </div>
      </mat-step>
      
      <!-- Idiomas -->
      <mat-step>
        <ng-template matStepLabel>{{ 'profile.languagesManagement' | translate }}</ng-template>
        
        <div class="step-content">
          <div class="section-header">
            <h3>{{ 'profile.languages' | translate }}</h3>
            <button mat-raised-button color="accent" type="button" (click)="addLanguage()">
              <mat-icon>add</mat-icon>
              {{ 'profile.addLanguage' | translate }}
            </button>
          </div>
          
          <div *ngIf="languagesArray.length === 0" class="empty-state">
            <p>{{ 'profile.noLanguagesAdded' | translate }}</p>
            <button mat-raised-button color="primary" type="button" (click)="addLanguage()">
              {{ 'profile.addFirstLanguage' | translate }}
            </button>
          </div>
          
          <div formArrayName="languages" class="languages-list">
            <div *ngFor="let languageGroup of languagesArray.controls; let i = index" 
                 [formGroupName]="i" class="language-item">
              <mat-form-field appearance="outline">
                <mat-label>{{ 'profile.language' | translate }}</mat-label>
                <mat-select formControlName="language" required>
                  <mat-option *ngFor="let language of availableLanguages" [value]="language.code">
                    {{ getLocalizedLanguageName(language) }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>{{ 'profile.level' | translate }}</mat-label>
                <mat-select formControlName="level" required>
                  <mat-option value="A1">A1</mat-option>
                  <mat-option value="A2">A2</mat-option>
                  <mat-option value="B1">B1</mat-option>
                  <mat-option value="B2">B2</mat-option>
                  <mat-option value="C1">C1</mat-option>
                  <mat-option value="C2">C2</mat-option>
                  <mat-option value="Native">Native</mat-option>
                </mat-select>
              </mat-form-field>
              
              <button mat-icon-button color="warn" type="button" (click)="removeLanguage(i)">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </div>
        
        <div class="step-actions">
          <button mat-button matStepperPrevious>{{ 'common.back' | translate }}</button>
          <button mat-raised-button color="primary" matStepperNext>
            {{ 'common.next' | translate }}
          </button>
        </div>
      </mat-step>
      
      <!-- Certificaciones -->
      <mat-step>
        <ng-template matStepLabel>{{ 'profile.certificationsManagement' | translate }}</ng-template>
        
        <div class="step-content">
          <div class="section-header">
            <h3>{{ 'profile.certifications' | translate }}</h3>
            <button mat-raised-button color="accent" type="button" (click)="addCertification()">
              <mat-icon>add</mat-icon>
              {{ 'profile.addCertification' | translate }}
            </button>
          </div>
          
          <div formArrayName="certifications" class="certifications-list">
            <div *ngFor="let certificationGroup of certificationsArray.controls; let i = index" 
                 [formGroupName]="i" class="certification-item">
              <mat-form-field appearance="outline">
                <mat-label>{{ 'profile.certificationName' | translate }}</mat-label>
                <input matInput formControlName="name" required>
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>{{ 'profile.issuer' | translate }}</mat-label>
                <input matInput formControlName="issuer">
              </mat-form-field>
              
              <button mat-icon-button color="warn" type="button" (click)="removeCertification(i)">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </div>
        
        <div class="step-actions">
          <button mat-button matStepperPrevious>{{ 'common.back' | translate }}</button>
          <button mat-raised-button color="primary" matStepperNext>
            {{ 'common.next' | translate }}
          </button>
        </div>
      </mat-step>
      
      <!-- Disponibilidad -->
      <mat-step>
        <ng-template matStepLabel>{{ 'profile.availabilityManagement' | translate }}</ng-template>
        
        <div class="step-content">
          <div class="section-header">
            <h3>{{ 'profile.availability' | translate }}</h3>
            <button mat-raised-button color="accent" type="button" (click)="addAvailability()">
              <mat-icon>add</mat-icon>
              {{ 'profile.addAvailability' | translate }}
            </button>
          </div>
          
          <div formArrayName="availability" class="availability-list">
            <div *ngFor="let availabilityGroup of availabilityArray.controls; let i = index" 
                 [formGroupName]="i" class="availability-item">
              <mat-form-field appearance="outline">
                <mat-label>{{ 'profile.weekDay' | translate }}</mat-label>
                <mat-select formControlName="weekDay" required>
                  <mat-option *ngFor="let day of weekDays" [value]="day">
                    {{ ('weekDays.' + day) | translate }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              
              <mat-form-field appearance="outline">
                <mat-label>{{ 'profile.hours' | translate }}</mat-label>
                <input matInput formControlName="hours" required 
                       [matTooltip]="'profile.hoursTooltip' | translate"
                       placeholder="9,10,14,15">
              </mat-form-field>
              
              <button mat-icon-button color="warn" type="button" (click)="removeAvailability(i)">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </div>
        
        <div class="step-actions">
          <button mat-button matStepperPrevious>{{ 'common.back' | translate }}</button>
          <button mat-raised-button color="primary" type="submit">
            {{ 'common.save' | translate }}
          </button>
        </div>
      </mat-step>
    </mat-stepper>
  </form>
  
  <div mat-dialog-actions align="end">
    <button mat-button type="button" (click)="onCancel()">
      {{ 'common.cancel' | translate }}
    </button>
  </div>
</div>
